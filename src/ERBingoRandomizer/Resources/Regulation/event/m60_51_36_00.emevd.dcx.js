// ==EMEVD==
// @docs    er-common.emedf.json
// @compress    DCX_KRAK
// @game    Sekiro
// @string    "N:\\GR\\data\\Param\\event\\common_func.emevd\u0000N:\\GR\\data\\Param\\event\\common_macro.emevd\u0000\u0000\u0000\u0000\u0000\u0000"
// @linked    [0,82]
// @version    3.5
// ==/EMEVD==

// コンストラクタ -- constructor
$Event(0, Default, function() {
    $InitializeEvent(0, 1051362580);
    $InitializeCommonEvent(0, 9005810, 1051360800, 1051360000, 1051360950, 1051361950, 5);
    $InitializeCommonEvent(0, 90005100, 76458, 76419, 1051361981, 77410, 4, 78410, 78411, 78412, 78413, 78414, 78415, 78416, 78417, 78418, 78419);
    RegisterBonfire(1051360001, 1051361951, 0, 0, 0, 10);
    $InitializeCommonEvent(0, 90005100, 76458, 76420, 1051361980, 77410, 3, 78410, 78411, 78412, 78413, 78414, 78415, 78416, 78417, 78418, 78419);
    if (EventFlag(57)) {
        $InitializeCommonEvent(0, 90005695, 1051362501, 1051361501, 200, 0, 802004070, 1, 0, 1);
    }
    if (EventFlag(56)) {
        $InitializeCommonEvent(0, 90005695, 1051362501, 1051361501, 200, 0, 802004060, 1, 0, 1);
    }
    if (EventFlag(55)) {
        $InitializeCommonEvent(0, 90005695, 1051362501, 1051361501, 200, 0, 802004050, 1, 0, 1);
    }
    if (EventFlag(54)) {
        $InitializeCommonEvent(0, 90005695, 1051362501, 1051361501, 200, 0, 802004040, 1, 0, 1);
    }
    if (EventFlag(53)) {
        $InitializeCommonEvent(0, 90005695, 1051362501, 1051361501, 200, 0, 802004030, 1, 0, 1);
    }
    if (EventFlag(52)) {
        $InitializeCommonEvent(0, 90005695, 1051362501, 1051361501, 200, 0, 802004020, 1, 0, 1);
    }
    if (EventFlag(51)) {
        $InitializeCommonEvent(0, 90005695, 1051362501, 1051361501, 200, 0, 802004010, 1, 0, 1);
    }
    if (EventFlag(50)) {
        $InitializeCommonEvent(0, 90005695, 1051362501, 1051361501, 200, 0, 802004000, 1, 0, 1);
    }
    if (EventFlag(57)) {
        $InitializeCommonEvent(0, 90005695, 1051362503, 1051361503, 200, 0, 802004070, 1, 0, 1);
    }
    if (EventFlag(56)) {
        $InitializeCommonEvent(0, 90005695, 1051362503, 1051361503, 200, 0, 802004060, 1, 0, 1);
    }
    if (EventFlag(55)) {
        $InitializeCommonEvent(0, 90005695, 1051362503, 1051361503, 200, 0, 802004050, 1, 0, 1);
    }
    if (EventFlag(54)) {
        $InitializeCommonEvent(0, 90005695, 1051362503, 1051361503, 200, 0, 802004040, 1, 0, 1);
    }
    if (EventFlag(53)) {
        $InitializeCommonEvent(0, 90005695, 1051362503, 1051361503, 200, 0, 802004030, 1, 0, 1);
    }
    if (EventFlag(52)) {
        $InitializeCommonEvent(0, 90005695, 1051362503, 1051361503, 200, 0, 802004020, 1, 0, 1);
    }
    if (EventFlag(51)) {
        $InitializeCommonEvent(0, 90005695, 1051362503, 1051361503, 200, 0, 802004010, 1, 0, 1);
    }
    if (EventFlag(50)) {
        $InitializeCommonEvent(0, 90005695, 1051362503, 1051361503, 200, 0, 802004000, 1, 0, 1);
    }
    $InitializeEvent(0, 1051362216, 1051362500, 1051361500, 200, 0, 802004000, 1, 0, 1, 50);
    $InitializeEvent(1, 1051362216, 1051362500, 1051361500, 200, 0, 802004010, 1, 0, 1, 51);
    $InitializeEvent(2, 1051362216, 1051362500, 1051361500, 200, 0, 802004020, 1, 0, 1, 52);
    $InitializeEvent(3, 1051362216, 1051362500, 1051361500, 200, 0, 802004030, 1, 0, 1, 53);
    $InitializeEvent(4, 1051362216, 1051362500, 1051361500, 200, 0, 802004040, 1, 0, 1, 54);
    $InitializeEvent(5, 1051362216, 1051362500, 1051361500, 200, 0, 802004050, 1, 0, 1, 55);
    $InitializeEvent(6, 1051362216, 1051362500, 1051361500, 200, 0, 802004060, 1, 0, 1, 56);
    $InitializeEvent(7, 1051362216, 1051362500, 1051361500, 200, 0, 802004070, 1, 0, 1, 57);
    $InitializeCommonEvent(0, 900005610, 1051361650, 100, 800, 0);
    $InitializeCommonEvent(0, 900005610, 1051361651, 100, 800, 0);
    $InitializeCommonEvent(0, 900005610, 1051361652, 100, 800, 0);
    $InitializeCommonEvent(0, 900005610, 1051361653, 100, 800, 0);
    $InitializeCommonEvent(0, 900005610, 1051361654, 100, 800, 0);
    $InitializeCommonEvent(0, 900005610, 1051361656, 100, 800, 0);
    $InitializeCommonEvent(0, 900005610, 1051361657, 100, 800, 0);
    $InitializeCommonEvent(0, 90005605, 1051361600, 60, 50, 36, 0, 1050360600, 0, 1051362650, 1051362651, 1051362652, 9410, 30040, 0, 0);
    $InitializeEvent(0, 1051362800);
    $InitializeEvent(0, 1051362810);
    $InitializeEvent(0, 1051362849);
    $InitializeEvent(0, 1051362630, 1051361630);
    $InitializeEvent(1, 1051362630, 1051361631);
    $InitializeEvent(2, 1051362630, 1051361632);
    $InitializeEvent(3, 1051362630, 1051361633);
    $InitializeEvent(0, 1051362210);
    $InitializeEvent(0, 1051362215);
    $InitializeEvent(0, 1051362200);
    $InitializeEvent(0, 1051362220);
    $InitializeEvent(0, 1051362230);
    $InitializeCommonEvent(0, 90005261, 1051360200, 1051362200, 10, 0, -1);
    $InitializeCommonEvent(0, 90005251, 1051360210, 10, 0, -1);
    $InitializeCommonEvent(0, 90005251, 1051360211, 10, 0, -1);
    $InitializeCommonEvent(0, 90005300, 1051360291, 1051360291, 1051360700, 0, 0);
    $InitializeCommonEvent(0, 90005300, 1051360292, 1051360292, 1051360800, 0, 0);
    $InitializeEvent(0, 1051362340, 1051360340);
    $InitializeCommonEvent(0, 90005250, 1051360422, 1051362422, 0, -1);
    $InitializeCommonEvent(0, 90005250, 1051360474, 1051362422, 0, -1);
    $InitializeCommonEvent(0, 90005250, 1051360475, 1051362422, 0, -1);
    $InitializeCommonEvent(0, 90005250, 1051360476, 1051362422, 0, -1);
    $InitializeCommonEvent(0, 90005250, 1051360490, 1051362490, 0, -1);
    $InitializeCommonEvent(0, 90005501, 1051360510, 1051360511, 0, 1051361510, 1051361511, 1051361512, 1051360512);
    $InitializeEvent(0, 1051362510);
    $InitializeCommonEvent(0, 90005490, 1051360400, 1051360401, 1051361400, 0, 0, 1051362400, 1);
    $InitializeCommonEvent(0, 90005490, 1051360402, 1051360403, 1051361402, 0, 0, 1051362402, 1);
    $InitializeCommonEvent(0, 90005511, 1051360560, 1051361560, 1051363560, 99020, 0);
    $InitializeCommonEvent(0, 90005512, 1051360560, 1051362560, 1051362561);
    $InitializeCommonEvent(0, 1051362560, 1051361562);
    $InitializeCommonEvent(1, 1051362560, 1051361564);
    $InitializeCommonEvent(2, 1051362560, 1051361566);
    $InitializeCommonEvent(3, 1051362560, 1051361568);
    $InitializeEvent(0, 1051363710, 1051360705);
    $InitializeEvent(0, 1051363711);
    $InitializeEvent(0, 1051360720, 1051360720);
    $InitializeEvent(0, 1051360721);
    $InitializeEvent(0, 1051363725, 1051360700);
    $InitializeEvent(0, 1051363726, 1051360701);
    $InitializeEvent(0, 1051363727);
    $InitializeCommonEvent(0, 90005708, 1051360700, 3360, 1051362700);
    $InitializeEvent(0, 1051360730, 1051360715, 0, 1);
    $InitializeEvent(1, 1051360730, 1051360730, 90100, 1);
    $InitializeEvent(2, 1051360730, 1051360735, 90101, 0);
    $InitializeEvent(0, 1051360734, 1051360735);
    $InitializeEvent(0, 1051360735, 1051360725, 0, 1);
    $InitializeEvent(0, 1051362500);
    $InitializeEvent(0, 1051362490, 1051362710);
});

// プリコンストラクタ -- preconstructor
$Event(50, Default, function() {
    SetCharacterBackreadState(1051360700, true);
    SetCharacterBackreadState(1051360701, true);
    SetCharacterBackreadState(1051360702, true);
    SetCharacterBackreadState(1051360705, true);
    SetCharacterBackreadState(1051360715, true);
    SetCharacterBackreadState(1051360720, true);
    SetCharacterBackreadState(1051360725, true);
    SetCharacterBackreadState(1051360730, true);
    SetCharacterBackreadState(1051360735, true);
    EnableAssetInvunerability(1051361700);
    $InitializeEvent(0, 1051362519);
});

// 祭り時敵配置イベント -- Festival enemy placement event
$Event(1051362200, Restart, function() {
    if (EventFlag(9413)) {
        EnableCharacter(1051365200);
        EnableAsset(1051361400);
        EnableAsset(1051361402);
        EndEvent();
    }
    EndIf(!EventFlag(9410));
    WaitFor(EventFlag(9410));
    DisableCharacter(1051365200);
    DisableAsset(1051361400);
    DisableAsset(1051361402);
});

// 祭り時霧壁を無効化する -- Disable the festival fog wall
$Event(1051362210, Restart, function() {
    EndIf(!EventFlag(9410) || EventFlag(9413));
    DisableAsset(1051361800);
    DisableAsset(1051361801);
});

// 祭り時処刑台を有効化する -- Activate the execution platform during festivals
$Event(1051362215, Restart, function() {
    EndIf(EventFlag(9410) && !EventFlag(9413));
    DisableAsset(1051361500);
});

// 常駐ダメージアセット_破壊有り -- Permanent damage asset_destructed
$Event(1051362216, Restart, function(eventFlagId, assetEntityId, dummypolyId, endingDummypolyId, behaviorId, radius, lifespan, repetitionTimeS, eventFlagId2) {
    EndIf(!EventFlag(eventFlagId2));
    DeleteAssetEvent(eventFlagId);
    EndIf(!EventFlag(9410) || EventFlag(9413));
    EndIf(AssetDestroyed(assetEntityId));
    if (Signed(0) == endingDummypolyId) {
        CreateDamagingAsset(eventFlagId, assetEntityId, dummypolyId, behaviorId, DamageTargetType.Character, radius, lifespan, repetitionTimeS);
    } else {
        CreateBigDamagingAsset(eventFlagId, assetEntityId, dummypolyId, endingDummypolyId, behaviorId, DamageTargetType.Character, radius, lifespan, repetitionTimeS);
    }
    WaitFor(AssetDestroyed(eventFlagId));
    DeleteAssetEvent(eventFlagId);
});

// ラダーン祭り状態遷移 -- Radhan festival state transition
$Event(1051362220, Restart, function() {
    DisableAsset(1051361690);
    DeleteAssetfollowingSFX(1051361690, true);
    ReproduceAssetAnimation(1051361520, 0);
    if (!EventFlag(1051360230)) {
        EndIf(EventFlag(9412) || EventFlag(9413) || EventFlag(1252380800));
        if (!EventFlag(9411)) {
            WaitFor(EventFlag(9411));
            SetEventFlagID(9021, ON);
            PlayCutsceneToPlayer(60510000, CutscenePlayMode.Unskippable, 10000);
            WaitFixedTimeRealFrames(1);
        }
L1:
        ReproduceAssetAnimation(1051361520, 2);
        EnableAsset(1051361690);
        CreateAssetfollowingSFX(1051361690, 101, 5);
        SetCurrentTime(3, 30, 0, false, false, false, 0, 0, 0);
        ChangeWeather(Weather.Default, -1, false);
        if (!EventFlag(76303)) { // altus highway
            SetEventFlagID(76303, ON);   
        }
        if (!EventFlag(76353)) { // road of iniquity
            SetEventFlagID(76353, ON);
        }
        if (!EventFlag(76551)) { // inner consecrated
            SetEventFlagID(76551, ON);
        }
        if (!EventFlag(76521)) { // snow valley ruins
            SetEventFlagID(76521, ON);
        }
        if (!EventFlag(71250)) { // cocoon of empyrean
            SetEventFlagID(71250, ON);
        }
        EndEvent();
    }
L2:
    ReproduceAssetAnimation(1051361520, 2);
    EndEvent();
});

// 領主後ろの扉がラダーン祭り終了後特定条件で開く判定 -- The door behind the lord will open under certain conditions after the Radan Festival ends.
$Event(1051362230, Restart, function() {
    EndIf(EventFlag(1051360230));
    WaitFor(EventFlag(9412) && EventFlag(1051360800) && InArea(10000, 1051362230));
    ReproduceAssetAnimation(1051361520, 2);
    SetEventFlagID(1051360230, ON);
    EndEvent();
});

// トロル飛び降りイベント -- troll jumping event
$Event(1051362340, Restart, function(chrEntityId) {
    EndIf(EventFlag(1051362340));
    DisableCharacterAI(chrEntityId);
    WaitFor(
        HasDamageType(1051360340, 0, DamageType.Unspecified)
            || CharacterHasStateInfo(chrEntityId, 436)
            || CharacterHasStateInfo(chrEntityId, 2)
            || CharacterHasStateInfo(chrEntityId, 5)
            || CharacterHasStateInfo(chrEntityId, 6)
            || CharacterHasStateInfo(chrEntityId, 260)
            || (InArea(10000, 1051362340)
                && ((CharacterType(10000, TargetType.BlackPhantom) && CharacterHasSpEffect(10000, 3710))
                    || CharacterType(10000, TargetType.Alive)
                    || CharacterType(10000, TargetType.GrayPhantom)
                    || CharacterType(10000, TargetType.WhitePhantom))));
    SetEventFlagID(1051362340, ON);
    EnableCharacterAI(chrEntityId);
    ForceAnimationPlayback(1051360340, 20016, false, true, false);
    SetCharacterHome(1051360340, 1051362341);
});

// 常時攻撃禁止区域設定 -- Setting a no-attack zone at all times
$Event(1051362490, Restart, function(areaEntityId) {
    DisableNetworkSync();
    WaitFor(InArea(20000, areaEntityId));
    SetSpEffect(20000, 9621);
    WaitFixedTimeSeconds(0.1);
    WaitFor(!InArea(20000, areaEntityId));
    WaitFixedTimeSeconds(0.1);
    if (!(EventFlag(9410) && !EventFlag(9413) && InArea(20000, 1051362500))) {
        ClearSpEffect(20000, 9621);
    }
    RestartEvent();
});

// 攻撃禁止区域設定 -- No-attack zone setting
$Event(1051362500, Restart, function() {
    DisableNetworkSync();
    if (!EventFlag(9413)) {
        WaitFor(
            InArea(20000, 1051362500)
                && EventFlag(9410)
                && !HasMultiplayerState(MultiplayerState.Invasion));
        if (!EventFlag(9413)) {
            SetSpEffect(20000, 9621);
            WaitFixedTimeSeconds(0.1);
            WaitFor(!InArea(20000, 1051362500) || HasMultiplayerState(MultiplayerState.Invasion));
            WaitFixedTimeSeconds(0.1);
            if (!InArea(20000, 1051362710)) {
                ClearSpEffect(20000, 9621);
            }
            RestartEvent();
        }
    }
L0:
    ClearSpEffect(20000, 9621);
    EndEvent();
});

// エレベータイベント起動 -- Elevator event activation
$Event(1051362510, Default, function() {
    $InitializeCommonEvent(0, 90005500, 1051360510, 1051360511, 0, 1051361510, 1051361511, 1051363511, 1051361512, 1051363512, 1051362511, 1051362512, 1051360512, 1051360513, 0);
});

// エレベーター初期フラグ -- Elevator initial flag
$Event(1051362519, Default, function() {
    EndIf(EventFlag(1051360514));
    SetEventFlagID(1051360514, ON);
    SetEventFlagID(1051360519, OFF);
    SetEventFlagID(1051360510, ON);
});

// 砦_一方通行扉_領域扉_XX -- Fort_One-way door_Area door_XX
$Event(1051362560, Default, function(assetEntityId) {
    GotoIf(L0, EventFlag(9413));
    GotoIf(L1, EventFlag(9410));
L0:
    ReproduceAssetAnimation(assetEntityId, 0);
    EndEvent();
L1:
    EndIf(EventFlag(9413));
    ReproduceAssetAnimation(assetEntityId, 2);
});

// 梯子登録 -- ladder registration
$Event(1051362580, Restart, function() {
    RegisterLadder(1051360580, 1051360581, 1051361580);
    RegisterLadder(1051360582, 1051360583, 1051361582);
    RegisterLadder(1051360584, 1051360585, 1051361584);
    RegisterLadder(1051360588, 1051360589, 1051361588);
    RegisterLadder(1051360590, 1051360591, 1051361590);
    RegisterLadder(1051360592, 1051360593, 1051361592);
    RegisterLadder(1051360594, 1051360595, 1051361594);
});

// アセット無効化_テスト_XX -- Asset invalidation_test_XX
$Event(1051362630, Restart, function(assetEntityId) {
    DisableAsset(assetEntityId);
});

// 篝火の導き_ボス篝火 -- Bonfire Guidance_Boss Bonfire
$Event(1051362650, Restart, function(eventFlagId, eventFlagId2, assetEntityId, eventFlagId3, thresholdValue, eventFlagId4, eventFlagId5, eventFlagId6, eventFlagId7, eventFlagId8, eventFlagId9) {
    WaitFor(EventFlag(1051360800));
    DeleteAssetfollowingSFX(assetEntityId, false);
    EndIf(!PlayerIsInOwnWorld());
    if (EventFlag(eventFlagId)) {
        SetEventFlagID(eventFlagId4, OFF);
        SetEventFlagID(eventFlagId5, OFF);
        SetEventFlagID(eventFlagId6, OFF);
        SetEventFlagID(eventFlagId7, OFF);
        SetEventFlagID(eventFlagId8, OFF);
        SetEventFlagID(eventFlagId9, OFF);
        EndEvent();
    }
L3:
    EndIf(EventValue(eventFlagId3, 3) > thresholdValue);
    if (!EventFlag(9000)) {
        CreateAssetfollowingSFX(assetEntityId, 100, 6400);
    }
    WaitFor(EventFlag(eventFlagId) || (EventFlag(eventFlagId2) && !EventFlag(9000)));
    RestartIf(EventFlag(eventFlagId));
    RestartIf(EventValue(eventFlagId3, 3) > thresholdValue);
    CreateAssetfollowingSFX(assetEntityId, 100, 6400);
    if (thresholdValue == 0) {
        SetEventFlagID(eventFlagId4, ON);
        EventValueOperation(eventFlagId3, 3, 0, 0, 1, CalculationType.Assign);
    } else {
        SetEventFlagID(eventFlagId4, OFF);
    }
    if (thresholdValue == 1) {
        SetEventFlagID(eventFlagId5, ON);
        EventValueOperation(eventFlagId3, 3, 1, 0, 1, CalculationType.Assign);
    } else {
        SetEventFlagID(eventFlagId5, OFF);
    }
    if (thresholdValue == 2) {
        SetEventFlagID(eventFlagId6, ON);
        EventValueOperation(eventFlagId3, 3, 2, 0, 1, CalculationType.Assign);
    } else {
        SetEventFlagID(eventFlagId6, OFF);
    }
    if (thresholdValue == 3) {
        SetEventFlagID(eventFlagId7, ON);
        EventValueOperation(eventFlagId3, 3, 3, 0, 1, CalculationType.Assign);
    } else {
        SetEventFlagID(eventFlagId7, OFF);
    }
    if (thresholdValue == 4) {
        SetEventFlagID(eventFlagId8, ON);
        EventValueOperation(eventFlagId3, 3, 4, 0, 1, CalculationType.Assign);
    } else {
        SetEventFlagID(eventFlagId8, OFF);
    }
    if (thresholdValue == 5) {
        SetEventFlagID(eventFlagId9, ON);
        EventValueOperation(eventFlagId3, 3, 5, 0, 1, CalculationType.Assign);
    } else {
        SetEventFlagID(eventFlagId9, OFF);
    }
    WaitFor(EventValue(eventFlagId3, 3) != thresholdValue || EventFlag(eventFlagId));
    WaitFixedTimeFrames(1);
    RestartEvent();
});

// ボス撃破 -- Defeat the boss
$Event(1051362800, Restart, function() {
    EndIf(EventFlag(1051360800));
    EndIf(EventFlag(9410) && !EventFlag(9413));
    WaitFor(CharacterHPValue(1051360800) <= 0 && CharacterHPValue(1051360801) <= 0);
    WaitFixedTimeSeconds(4);
    PlaySE(1051360800, SoundType.SFX, 888880000);
    WaitFor(CharacterDead(1051360800) && CharacterDead(1051360801));
    HandleBossDefeatAndDisplayBanner(1051360800, TextBannerType.GreatEnemyFelled);
    SetEventFlagID(1051360800, ON);
    SetEventFlagID(9183, ON);
    if (PlayerIsInOwnWorld()) {
        SetEventFlagID(61183, ON);
    }
});

// ボス出現 -- Boss appears
$Event(1051362810, Restart, function() {
    if (EventFlag(1051360800)) {
        DisableCharacter(1051360800);
        DisableCharacterCollision(1051360800);
        ForceCharacterDeath(1051360800, false);
        DisableCharacter(1051360801);
        DisableCharacterCollision(1051360801);
        ForceCharacterDeath(1051360801, false);
        EndEvent();
    }
L0:
    if (EventFlag(9410)) {
        if (!EventFlag(9413)) {
            DisableCharacter(1051360800);
            DisableCharacterCollision(1051360800);
            ForceCharacterDeath(1051360800, false);
            DisableCharacter(1051360801);
            DisableCharacterCollision(1051360801);
            ForceCharacterDeath(1051360801, false);
            EndEvent();
        }
    }
L5:
    DisableCharacterAI(1051360801);
    DisableCharacterAI(1051360800);
    WaitFor(EventFlag(1051362805) && cond && InArea(10000, 1051362800));
    EnableCharacterAI(1051360801);
    SetNetworkUpdateRate(1051360801, true, CharacterUpdateFrequency.AlwaysUpdate);
    DisplayBossHealthBar(Enabled, 1051360801, 0, 903460501);
    WaitFor(
        HPRatio(1051360801) < 0.5
            || CharacterDead(1051360801)
            || ElapsedSeconds(30)
            || HasDamageType(1051360800, 10000, DamageType.Unspecified));
    ForceAnimationPlayback(1051360800, 20011, false, false, false);
    EnableCharacterAI(1051360800);
    SetNetworkUpdateRate(1051360800, true, CharacterUpdateFrequency.AlwaysUpdate);
    DisplayBossHealthBar(Enabled, 1051360800, 1, 902500500);
    SetCharacterHome(1051360800, 1051362299);
});

// ボス_イベント起動 -- Boss_event activation
$Event(1051362849, Restart, function() {
    EndIf(EventFlag(9410) && !EventFlag(9413));
    $InitializeCommonEvent(0, 9005800, 1051360800, 1051361800, 1051362800, 1051362805, 1051365800, 10000, 0, 0);
    $InitializeCommonEvent(0, 9005801, 1051360800, 1051361800, 1051362800, 1051362805, 1051362806, 10000);
    $InitializeCommonEvent(0, 9005811, 1051360800, 1051361800, 5, 0);
    $InitializeCommonEvent(0, 9005811, 1051360800, 1051361801, 3, 0);
    $InitializeCommonEvent(0, 9005822, 1051360800, 920200, 1051362805, 1051362806, 0, 1051362802, 0, 0);
});

// 痩せ馬のラダーンとの戦闘開始 -- The battle with the skinny horse Ladan begins.
$Event(1051363700, Restart, function() {
    WaitFor(EventFlag(1051362702) && EventFlag(9410) && !EventFlag(9411));
    PlayCutsceneToPlayer(60510000, CutscenePlayMode.Skippable, 10000);
    WaitFixedTimeRealFrames(1);
    SetEventFlagID(9411, ON);
    EndEvent();
});

// 壺マイヤー_NPC初期化イベント_祭り開催待ち -- Tsubo Mayer_NPC initialization event_Waiting for the festival
$Event(1051363710, Restart, function(chrEntityId) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3660)) {
            SetEventFlagID(1043399303, OFF);
        }
    }
L19:
    if (!EventFlag(3667)) {
        DisableCharacter(chrEntityId);
        SetCharacterBackreadState(chrEntityId, true);
        WaitFor(EventFlag(3667));
        RestartEvent();
    }
L6:
    GotoIf(L1, EventFlag(3660));
    GotoIf(L2, EventFlag(3661));
    GotoIf(L4, EventFlag(3663));
L1:
    EnableCharacter(chrEntityId);
    SetCharacterBackreadState(chrEntityId, false);
    ForceAnimationPlayback(chrEntityId, 930010, false, false, false);
    Goto(L20);
L2:
    EnableCharacter(chrEntityId);
    SetCharacterBackreadState(chrEntityId, false);
    SetCharacterTeamType(chrEntityId, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(chrEntityId);
    DisableCharacter(chrEntityId);
    SetCharacterBackreadState(chrEntityId, true);
    Goto(L20);
L20:
    WaitFor(!EventFlag(3667));
    RestartEvent();
});

// 壺マイヤー_移動処理_祭り開催待ち -- Tsubo Meyer_Moving process_Waiting for the festival
$Event(1051363711, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(9412));
    WaitFor(EventFlag(9410));
    SetEventFlagID(3678, ON);
    EndEvent();
});

// NPC216_狼頭の戦士_NPC初期化イベント_ラダーン祭り参加待ち -- NPC216_Wolf-headed Warrior_NPC Initialization Event_Waiting to participate in the Radhan Festival
$Event(1051360720, Restart, function(chrEntityId) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3600)) {
            SetEventFlagID(1051369352, OFF);
        }
    }
L19:
    GotoIf(L11, EventFlag(3611));
    GotoIf(L12, EventFlag(3612));
    DisableCharacter(chrEntityId);
    SetCharacterBackreadState(chrEntityId, true);
    WaitFor(AnyBatchEventFlags(3611, 3612));
    RestartEvent();
L11:
L12:
    GotoIf(L1, EventFlag(3601));
    GotoIf(L2, EventFlag(3602));
    GotoIf(L3, EventFlag(3603));
    SetCharacterBackreadState(chrEntityId, false);
    EnableCharacter(chrEntityId);
    ForceAnimationPlayback(chrEntityId, 930010, false, false, false);
    Goto(L20);
L1:
L2:
L3:
    SetCharacterBackreadState(chrEntityId, true);
    DisableCharacter(chrEntityId);
    Goto(L20);
L20:
    WaitFor(!AnyBatchEventFlags(3611, 3612));
    RestartEvent();
});

// NPC216_狼頭の戦士_リアルタイム遷移_ラダーン祭り参加待ち -- NPC216_Wolf-Headed Warrior_Real-time transition_Waiting for Radan Festival participation
$Event(1051360721, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    EndIf(EventFlag(9412));
    WaitFor(AnyBatchEventFlags(3605, 3610) && EventFlag(9410));
    SetEventFlagID(1051362739, ON);
    SetEventFlagID(3618, ON);
});

// 平原砦の領主_ﾌｪｰｽﾞ1_3_NPC初期化イベント -- Lord of Plains Fort_Phase 1_3_NPC initialization event
$Event(1051363725, Restart, function(assetEntityId) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3360) && EventFlag(1051369203)) {
            SetEventFlagID(1051369203, OFF);
        }
    }
L10:
    DisableCharacter(assetEntityId);
    SetCharacterBackreadState(assetEntityId, true);
    DisableAssetInvunerability(1051361700);
    if (!(EventFlag(3365) || EventFlag(3367))) {
        WaitFor(EventFlag(3365) || EventFlag(3367));
        RestartEvent();
    }
L0:
    GotoIf(L1, EventFlag(3360));
    GotoIf(L2, EventFlag(3361));
    GotoIf(L4, EventFlag(3363));
L1:
    EnableCharacter(assetEntityId);
    SetCharacterBackreadState(assetEntityId, false);
    ForceAnimationPlayback(assetEntityId, 90100, false, false, false);
    DisableCharacterGravity(assetEntityId);
    EnableAssetInvunerability(1051361700);
    Goto(L20);
L2:
    EnableCharacter(assetEntityId);
    SetCharacterBackreadState(assetEntityId, false);
    SetCharacterTeamType(assetEntityId, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(assetEntityId);
    DisableCharacter(assetEntityId);
    SetCharacterBackreadState(assetEntityId, true);
    DisableAsset(assetEntityId);
    Goto(L20);
L20:
    WaitFor(!(EventFlag(3365) || EventFlag(3367)));
    RestartEvent();
});

// 平原砦の領主_ﾌｪｰｽﾞ2_NPC初期化イベント -- Lord of Plains Fort_Phase 2_NPC initialization event
$Event(1051363726, Restart, function(assetEntityId) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
        if (EventFlag(3360) && EventFlag(1051369203)) {
            SetEventFlagID(1051369203, OFF);
        }
    }
L10:
    DisableCharacter(assetEntityId);
    SetCharacterBackreadState(assetEntityId, true);
    if (!EventFlag(3366)) {
        WaitFor(EventFlag(3366));
        RestartEvent();
    }
L0:
    GotoIf(L1, EventFlag(3360));
    GotoIf(L2, EventFlag(3361));
    GotoIf(L4, EventFlag(3363));
L1:
    EnableCharacter(assetEntityId);
    SetCharacterBackreadState(assetEntityId, false);
    ForceAnimationPlayback(assetEntityId, 90101, false, false, false);
    Goto(L20);
L2:
    EnableCharacter(assetEntityId);
    SetCharacterBackreadState(assetEntityId, false);
    SetCharacterTeamType(assetEntityId, TeamType.HostileNPC);
    Goto(L20);
L4:
    ForceCharacterTreasure(assetEntityId);
    DisableCharacter(assetEntityId);
    SetCharacterBackreadState(assetEntityId, true);
    DisableAsset(assetEntityId);
    Goto(L20);
L20:
    WaitFor(!EventFlag(3366));
    RestartEvent();
});

// 平原砦の領主_祭り会話挨拶自動会話 -- Lord of Plains Fort_Festival Conversation Greeting Automatic Conversation
$Event(1051363727, Restart, function() {
    EndIf(!PlayerIsInOwnWorld());
    SetCharacterTalkRange(1051360701, 17);
    EndIf(EventFlag(9413));
    SetCharacterTalkRange(1051360701, 80);
    WaitFor(EventFlag(3366) && !EventFlag(1051362701) && InArea(10000, 1051362701));
    SetNetworkconnectedEventFlagID(1051362700, ON);
    EndEvent();
});

// 名無しモブ_NPC初期化イベント_ラダーン祭り準備会場XX -- Anonymous Mob_NPC Initialization Event_Ladhan Festival Preparation Venue XX
$Event(1051360730, Restart, function(chrEntityId, animationId, value) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
        SetSpEffect(chrEntityId, 5005);
    }
L19:
    if (!(EventFlag(9410) && !EventFlag(9413))) {
        DisableCharacter(chrEntityId);
        SetCharacterBackreadState(chrEntityId, true);
        WaitFor(EventFlag(9410) && !EventFlag(9413));
        RestartEvent();
    }
L0:
    EnableCharacter(chrEntityId);
    SetCharacterBackreadState(chrEntityId, false);
    ForceAnimationPlayback(chrEntityId, animationId, false, false, false);
    if (value != 0) {
        DisableCharacterCollision(chrEntityId);
    }
    WaitFor(!(EventFlag(9410) && !EventFlag(9413)));
    RestartEvent();
});

// 名無しモブ_ジェスチャー入手 -- Anonymous mob_get gesture
$Event(1051360734, Restart, function(chrEntityId) {
    EndIf(!PlayerIsInOwnWorld());
    SetSpEffect(chrEntityId, 5005);
    WaitFor(
        EventFlag(9410)
            && !EventFlag(9413)
            && ActionButtonInArea(6000, chrEntityId)
            && PlayerIsInOwnWorld());
    ForceAnimationPlayback(chrEntityId, 90203, false, false, false);
    WaitFixedTimeSeconds(2.5);
    if (!EventFlag(60801)) {
        AwardGesture(1);
        SetEventFlagID(60801, ON);
    }
});

// トラゴス_NPC初期化イベント_ラダーン祭り準備会場 -- Tragos_NPC Initialization Event_Ladan Festival Preparation Venue
$Event(1051360735, Restart, function(chrEntityId, animationId, value) {
    DisableNetworkSync();
    WaitFixedTimeFrames(1);
    if (PlayerIsInOwnWorld()) {
        SetSpEffect(chrEntityId, 5005);
        if (!EventFlag(7606)) {
            SetNetworkconnectedEventFlagID(1051362735, ON);
        }
    }
L19:
    if (!(EventFlag(9410) && !EventFlag(9413) && EventFlag(1051362735))) {
        DisableCharacter(chrEntityId);
        SetCharacterBackreadState(chrEntityId, true);
        WaitFor(EventFlag(9410) && !EventFlag(9413) && EventFlag(1051362735));
        RestartEvent();
    }
L0:
    EnableCharacter(chrEntityId);
    SetCharacterBackreadState(chrEntityId, false);
    ForceAnimationPlayback(chrEntityId, animationId, false, false, false);
    if (value != 0) {
        DisableCharacterCollision(chrEntityId);
    }
    WaitFor(!(EventFlag(9410) && !EventFlag(9413) && EventFlag(1051362735)));
    RestartEvent();
});
